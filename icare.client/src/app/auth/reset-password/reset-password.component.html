<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-md-6" style="width: 400px">
      <div class="card border-0 shadow radius">
        <div class="card-body bg-bege-contrast radius w-100">
          <h2 class="text-center mb-4">Change Password</h2>
          <form (ngSubmit)="onReset()" #registerForm="ngForm">
            <!-- Current Password -->
            <div class="mb-3">
              <label for="currentPassword" class="w-100 text-start form-label"
                >Current Password:</label
              >
              <input
                type="password"
                id="currentPassword"
                name="currentPassword"
                class="form-control bg-bege"
                [ngClass]="{
                  'is-invalid':
                    currentPasswordInput.invalid &&
                    currentPasswordInput.touched,
                  'is-valid':
                    currentPasswordInput.valid && currentPasswordInput.touched
                }"
                [(ngModel)]="currentPassword"
                placeholder="Enter your current password"
                required
                minlength="8"
                #currentPasswordInput="ngModel"
              />

              <!-- Mensagem de erro -->
              <div
                *ngIf="
                  currentPasswordInput.invalid && currentPasswordInput.touched
                "
                class="text-danger"
              >
                <small *ngIf="currentPasswordInput.errors?.['required']"
                  >Current Password is required.</small
                >
                <small *ngIf="currentPasswordInput.errors?.['pattern']"
                  >Please enter a valid password.</small
                >
              </div>

              <!-- Mensagem de sucesso -->
              <div
                *ngIf="
                  currentPasswordInput.valid && currentPasswordInput.touched
                "
                class="text-success"
              >
                <small>Password looks good!</small>
              </div>
            </div>

            <!-- New Password -->
            <div class="mb-3">
              <label for="newPassword" class="w-100 text-start form-label"
                >New Password:</label
              >
              <input
                type="password"
                id="newPassword"
                name="newPassword"
                class="form-control bg-bege"
                [ngClass]="{
                  'is-invalid': !passwordIsValide() && newPasswordInput.touched,
                  'is-valid': passwordIsValide() && newPasswordInput.touched
                }"
                [(ngModel)]="newPassword"
                required
                placeholder="Enter the new password"
                minlength="8"
                #newPasswordInput="ngModel"
                (input)="validatePassword(newPassword)"
              />

              <!-- Mensagem de erro -->
              <div
                *ngIf="!passwordIsValide() && newPasswordInput.touched"
                class="text-danger d-flex flex-column"
              >
                <small *ngIf="newPasswordInput.errors?.['required']">
                  Password is required.
                </small>
                <small *ngIf="newPasswordInput.errors?.['minlength']">
                  Password must be at least 8 characters long.
                </small>
                <small *ngIf="passwordErrors.includes('lower')">
                  New Password must contain at least one lowercase
                  letter('a'-'z').
                </small>
                <small *ngIf="passwordErrors.includes('upper')">
                  New Password must contain at least one uppercase
                  letter('A'-'Z').
                </small>
                <small *ngIf="passwordErrors.includes('digit')">
                  New Password must contain at least one digit ('0'-'9').
                </small>
                <small *ngIf="passwordErrors.includes('nonAlphanumeric')">
                  New Password must contain at least one non-alphanumeric
                  character.
                </small>
              </div>
              <!-- Mensagem de sucesso -->
              <div *ngIf="passwordIsValide()" class="text-success">
                <small>New Password is Valide!</small>
              </div>
            </div>

            <!-- Confirm New Password -->
            <div class="mb-3">
              <label for="repeatPassword" class="w-100 text-start form-label">
                Confirm Password:
              </label>
              <input
                type="password"
                id="repeatPassword"
                name="repeatPassword"
                class="form-control bg-bege"
                [ngClass]="{
                  'is-invalid':
                    repeatPasswordInput.invalid && repeatPasswordInput.touched,
                  'is-valid':
                    repeatPasswordInput.valid && repeatPasswordInput.touched
                }"
                placeholder="Confirm new password"
                [(ngModel)]="repeatPassword"
                required
                minlength="8"
                #repeatPasswordInput="ngModel"
                (input)="validatePassword(repeatPassword)"
              />
              <!-- Mensagem de erro -->
              <div
                *ngIf="
                  repeatPasswordInput.invalid && repeatPasswordInput.touched
                "
                class="text-danger"
              >
                <small *ngIf="repeatPasswordInput.errors?.['required']">
                  Confirm password is required.
                </small>
                <small
                  *ngIf="
                    repeatPasswordInput.touched &&
                    newPassword !== repeatPassword
                  "
                >
                  Passwords do not match.
                </small>
              </div>
              <!-- Mensagem de sucesso -->
              <div
                *ngIf="
                  newPassword &&
                  repeatPassword &&
                  newPassword === repeatPassword &&
                  repeatPasswordInput.touched
                "
                class="text-success"
              >
                <small> Passwords match! </small>
              </div>
            </div>

            <!-- Error Message -->
            <div *ngIf="errorMessage" class="alert alert-danger">
              {{ errorMessage }}
            </div>

            <!-- Submit Button -->
            <div class="container d-flex flex-row gap-4">
              <button type="submit" class="btn bg-verde w-100">
                Reset password
              </button>
              <button type="reset" class="btn bg-vermelho w-100">
                Clear Form
              </button>
            </div>
          </form>
          <div class="text-center mt-3">
            <small>
              Already have an account?
              <a routerLink="/login" class="text-primary">Login here</a>.
            </small>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
