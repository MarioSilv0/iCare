<p *ngIf="!user"><em>Loading...</em></p>

<container customClass="custom-style">
  <form>
    <!-- Profile Image -->
    <profile-image [imageUrl]="user.picture" [editable]="true" (imageChange)="changePicture($event)" />

    <!-- Profile Name -->

  </form>
</container>

<form *ngIf="user" (ngSubmit)="updateUser()">
  <section id="userData">
    
    <div>
      <label for="userName">Nome</label>
      <input
        type="text"
        id="userName"
        name="userName"
        [(ngModel)]="user.name"
      />
      <label for="userEmail">Email</label>
      <input
        type="email"
        id="userEmail"
        name="userEmail"
        [(ngModel)]="user.email"
        required
      />
      <label for="userBirthdate">Data de Nascimento</label>
      <input
        type="date"
        id="userBirthdate"
        name="userBirthdate"
        [(ngModel)]="user.birthdate"
        min="1910-01-01"
        [max]="todayDate"
        required
      />
    </div>

    <div id="extraData">
      <div id="extraData-notifications">
        <label for="userNotificacions">Notificações</label>
        <input
          type="checkbox"
          id="userNotificacions"
          name="userNotificacions"
          [(ngModel)]="user.notifications"
        />
      </div>
      <div id="extraData-controls">
        <input
          class="rounded"
          type="button"
          value="Trocar Palavra-Passe"
          (click)="changePassword()"
        />
        <input type="submit" value="Salvar" class="submit-btn rounded" />
      </div>
    </div>
  </section>
  <section id="userCharacteristics">
    <label for="userHeight">Altura (m)</label>
    <input
      type="number"
      id="userHeight"
      name="userHeight"
      [(ngModel)]="user.height"
      min="0"
      max="3"
      required
    />
    <label for="userWeight">Peso (kg)</label>
    <input
      type="number"
      id="userWeight"
      name="userWeight"
      [(ngModel)]="user.weight"
      min="0"
      max="700"
      required
    />
  </section>
  <section>
    <p>Preferências</p>
    <div class="d-flex gap-1 bg-bege-contrast p-1 rounded">
      <input list="preferencesList"
             class="form-control"
             placeholder="Search preferences..."
             (change)="addPreference($event)" />
      <datalist id="preferencesList">
        <option *ngFor="let p of user.categories" [value]="p">
          {{ p }}
        </option>
      </datalist>
    </div>
    <div class="selected-items">
      <button (click)="removePreference(p)"
              *ngFor="let p of user.preferences"
              class="selected-item shadow">
        {{ p }}
      </button>
    </div>
  </section>

  <section>
    <p>Restrições</p>
    <div class="d-flex gap-1 bg-bege-contrast p-1 rounded">
      <input list="restrictionsList"
             class="form-control"
             placeholder="Search restrictions..."
             (change)="addRestriction($event)" />
      <datalist id="restrictionsList">
        <option *ngFor="let r of user.categories" [value]="r">
          {{ r }}
        </option>
      </datalist>
    </div>
    <div class="selected-items">
      <button *ngFor="let r of user.restrictions"
              (click)="removeRestriction(r)"
              class="selected-item">
        {{ r }}
      </button>
    </div>
  </section>
</form>
